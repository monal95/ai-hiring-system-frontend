{"ast":null,"code":"var _jsxFileName = \"D:\\\\Project\\\\gcc-hiring-system\\\\frontend\\\\src\\\\components\\\\ProctoringSystem.jsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef, useCallback } from 'react';\nimport '../styles/ProctoringSystem.css';\n\n/**\r\n * Enterprise-Grade Proctoring System\r\n * \r\n * Level 1: Basic Proctoring\r\n * - Full-screen enforcement\r\n * - Tab-switch detection\r\n * - Copy-paste blocking\r\n * - Time tracking\r\n * - Browser focus monitoring\r\n * \r\n * Level 2: Advanced Proctoring\r\n * - Webcam monitoring\r\n * - Face presence detection\r\n * - Multiple face detection\r\n * - Microphone activity monitoring\r\n * - Behavioral flags\r\n */\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst ProctoringSystem = ({\n  isActive = false,\n  onViolation,\n  onStatusChange,\n  candidateName = 'Candidate',\n  showPreview = true\n}) => {\n  _s();\n  // ============== State Management ==============\n  const [proctoringStatus, setProctoringStatus] = useState({\n    isFullscreen: false,\n    cameraEnabled: false,\n    microphoneEnabled: false,\n    faceDetected: false,\n    multipleFaces: false,\n    isTabFocused: true,\n    isBrowserFocused: true\n  });\n  const [violations, setViolations] = useState([]);\n  const [warnings, setWarnings] = useState([]);\n  const [stats, setStats] = useState({\n    tabSwitches: 0,\n    focusLost: 0,\n    faceNotDetected: 0,\n    multipleFacesDetected: 0,\n    copyAttempts: 0,\n    pasteAttempts: 0,\n    fullscreenExits: 0,\n    totalTime: 0,\n    activeTime: 0,\n    suspiciousBehaviors: 0\n  });\n  const [cameraError, setCameraError] = useState(null);\n  const [isInitialized, setIsInitialized] = useState(false);\n  const [showWarningModal, setShowWarningModal] = useState(false);\n  const [currentWarning, setCurrentWarning] = useState(null);\n\n  // ============== Refs ==============\n  const videoRef = useRef(null);\n  const canvasRef = useRef(null);\n  const streamRef = useRef(null);\n  const faceDetectionIntervalRef = useRef(null);\n  const timeTrackingIntervalRef = useRef(null);\n  const lastFaceDetectedRef = useRef(Date.now());\n  const audioContextRef = useRef(null);\n  const analyserRef = useRef(null);\n  const microphoneStreamRef = useRef(null);\n\n  // ============== Violation Recording ==============\n  const recordViolation = useCallback((type, severity, message) => {\n    const violation = {\n      id: Date.now(),\n      type,\n      severity,\n      // 'low', 'medium', 'high', 'critical'\n      message,\n      timestamp: new Date().toISOString()\n    };\n    setViolations(prev => [...prev, violation]);\n    if (onViolation) {\n      onViolation(violation);\n    }\n\n    // Show warning for medium+ severity\n    if (severity !== 'low') {\n      setCurrentWarning(violation);\n      setShowWarningModal(true);\n      setTimeout(() => setShowWarningModal(false), 4000);\n    }\n\n    // Update stats based on type\n    setStats(prev => {\n      const newStats = {\n        ...prev\n      };\n      switch (type) {\n        case 'tab_switch':\n          newStats.tabSwitches++;\n          break;\n        case 'focus_lost':\n          newStats.focusLost++;\n          break;\n        case 'face_not_detected':\n          newStats.faceNotDetected++;\n          break;\n        case 'multiple_faces':\n          newStats.multipleFacesDetected++;\n          break;\n        case 'copy_attempt':\n          newStats.copyAttempts++;\n          break;\n        case 'paste_attempt':\n          newStats.pasteAttempts++;\n          break;\n        case 'fullscreen_exit':\n          newStats.fullscreenExits++;\n          break;\n        default:\n          newStats.suspiciousBehaviors++;\n      }\n      return newStats;\n    });\n  }, [onViolation]);\n\n  // ============== Level 1: Basic Proctoring ==============\n\n  // Full-screen enforcement\n  const enterFullscreen = useCallback(async () => {\n    try {\n      const elem = document.documentElement;\n      if (elem.requestFullscreen) {\n        await elem.requestFullscreen();\n      } else if (elem.webkitRequestFullscreen) {\n        await elem.webkitRequestFullscreen();\n      } else if (elem.msRequestFullscreen) {\n        await elem.msRequestFullscreen();\n      }\n      setProctoringStatus(prev => ({\n        ...prev,\n        isFullscreen: true\n      }));\n    } catch (error) {\n      console.error('Fullscreen error:', error);\n      recordViolation('fullscreen_denied', 'high', 'Fullscreen mode was denied');\n    }\n  }, [recordViolation]);\n\n  // Fullscreen change handler\n  useEffect(() => {\n    const handleFullscreenChange = () => {\n      const isFullscreen = !!(document.fullscreenElement || document.webkitFullscreenElement || document.msFullscreenElement);\n      setProctoringStatus(prev => ({\n        ...prev,\n        isFullscreen\n      }));\n      if (!isFullscreen && isActive && isInitialized) {\n        recordViolation('fullscreen_exit', 'high', 'Exited fullscreen mode');\n        // Re-enter fullscreen after a short delay\n        setTimeout(() => {\n          if (isActive) enterFullscreen();\n        }, 1000);\n      }\n    };\n    document.addEventListener('fullscreenchange', handleFullscreenChange);\n    document.addEventListener('webkitfullscreenchange', handleFullscreenChange);\n    document.addEventListener('msfullscreenchange', handleFullscreenChange);\n    return () => {\n      document.removeEventListener('fullscreenchange', handleFullscreenChange);\n      document.removeEventListener('webkitfullscreenchange', handleFullscreenChange);\n      document.removeEventListener('msfullscreenchange', handleFullscreenChange);\n    };\n  }, [isActive, isInitialized, enterFullscreen, recordViolation]);\n\n  // Tab visibility detection\n  useEffect(() => {\n    const handleVisibilityChange = () => {\n      const isVisible = document.visibilityState === 'visible';\n      setProctoringStatus(prev => ({\n        ...prev,\n        isTabFocused: isVisible\n      }));\n      if (!isVisible && isActive) {\n        recordViolation('tab_switch', 'high', 'Switched to another tab');\n      }\n    };\n    document.addEventListener('visibilitychange', handleVisibilityChange);\n    return () => document.removeEventListener('visibilitychange', handleVisibilityChange);\n  }, [isActive, recordViolation]);\n\n  // Browser focus detection\n  useEffect(() => {\n    const handleFocus = () => {\n      setProctoringStatus(prev => ({\n        ...prev,\n        isBrowserFocused: true\n      }));\n    };\n    const handleBlur = () => {\n      setProctoringStatus(prev => ({\n        ...prev,\n        isBrowserFocused: false\n      }));\n      if (isActive) {\n        recordViolation('focus_lost', 'medium', 'Browser window lost focus');\n      }\n    };\n    window.addEventListener('focus', handleFocus);\n    window.addEventListener('blur', handleBlur);\n    return () => {\n      window.removeEventListener('focus', handleFocus);\n      window.removeEventListener('blur', handleBlur);\n    };\n  }, [isActive, recordViolation]);\n\n  // Copy-paste blocking\n  useEffect(() => {\n    const handleCopy = e => {\n      if (isActive) {\n        e.preventDefault();\n        recordViolation('copy_attempt', 'medium', 'Attempted to copy content');\n      }\n    };\n    const handlePaste = e => {\n      if (isActive) {\n        e.preventDefault();\n        recordViolation('paste_attempt', 'medium', 'Attempted to paste content');\n      }\n    };\n    const handleCut = e => {\n      if (isActive) {\n        e.preventDefault();\n        recordViolation('cut_attempt', 'medium', 'Attempted to cut content');\n      }\n    };\n\n    // Block right-click context menu\n    const handleContextMenu = e => {\n      if (isActive) {\n        e.preventDefault();\n        recordViolation('context_menu', 'low', 'Attempted to open context menu');\n      }\n    };\n\n    // Block keyboard shortcuts\n    const handleKeyDown = e => {\n      if (isActive) {\n        // Block Ctrl+C, Ctrl+V, Ctrl+X, Ctrl+A, F12, etc.\n        if (e.ctrlKey && ['c', 'v', 'x', 'a', 'u', 's', 'p'].includes(e.key.toLowerCase()) || e.key === 'F12' || e.ctrlKey && e.shiftKey && ['i', 'j', 'c'].includes(e.key.toLowerCase())) {\n          e.preventDefault();\n          recordViolation('keyboard_shortcut', 'low', `Blocked keyboard shortcut: ${e.key}`);\n        }\n      }\n    };\n    document.addEventListener('copy', handleCopy);\n    document.addEventListener('paste', handlePaste);\n    document.addEventListener('cut', handleCut);\n    document.addEventListener('contextmenu', handleContextMenu);\n    document.addEventListener('keydown', handleKeyDown);\n    return () => {\n      document.removeEventListener('copy', handleCopy);\n      document.removeEventListener('paste', handlePaste);\n      document.removeEventListener('cut', handleCut);\n      document.removeEventListener('contextmenu', handleContextMenu);\n      document.removeEventListener('keydown', handleKeyDown);\n    };\n  }, [isActive, recordViolation]);\n\n  // Time tracking\n  useEffect(() => {\n    if (isActive) {\n      timeTrackingIntervalRef.current = setInterval(() => {\n        setStats(prev => ({\n          ...prev,\n          totalTime: prev.totalTime + 1,\n          activeTime: proctoringStatus.isBrowserFocused && proctoringStatus.isTabFocused ? prev.activeTime + 1 : prev.activeTime\n        }));\n      }, 1000);\n    }\n    return () => {\n      if (timeTrackingIntervalRef.current) {\n        clearInterval(timeTrackingIntervalRef.current);\n      }\n    };\n  }, [isActive, proctoringStatus.isBrowserFocused, proctoringStatus.isTabFocused]);\n\n  // ============== Level 2: Advanced Proctoring ==============\n\n  // Initialize camera\n  const initializeCamera = useCallback(async () => {\n    try {\n      const stream = await navigator.mediaDevices.getUserMedia({\n        video: {\n          width: {\n            ideal: 640\n          },\n          height: {\n            ideal: 480\n          },\n          facingMode: 'user'\n        },\n        audio: true\n      });\n      streamRef.current = stream;\n      if (videoRef.current) {\n        videoRef.current.srcObject = stream;\n        await videoRef.current.play();\n      }\n\n      // Set up audio analysis\n      const audioTrack = stream.getAudioTracks()[0];\n      if (audioTrack) {\n        audioContextRef.current = new (window.AudioContext || window.webkitAudioContext)();\n        const source = audioContextRef.current.createMediaStreamSource(new MediaStream([audioTrack]));\n        analyserRef.current = audioContextRef.current.createAnalyser();\n        analyserRef.current.fftSize = 256;\n        source.connect(analyserRef.current);\n        microphoneStreamRef.current = stream;\n      }\n      setProctoringStatus(prev => ({\n        ...prev,\n        cameraEnabled: true,\n        microphoneEnabled: !!audioTrack\n      }));\n      setCameraError(null);\n      return true;\n    } catch (error) {\n      console.error('Camera initialization error:', error);\n      setCameraError(error.message || 'Failed to access camera');\n      recordViolation('camera_denied', 'critical', 'Camera access was denied');\n      return false;\n    }\n  }, [recordViolation]);\n\n  // Face detection using simple motion/presence detection\n  // (No ML library needed - uses pixel analysis)\n  const detectFacePresence = useCallback(() => {\n    if (!videoRef.current || !canvasRef.current) return;\n    const video = videoRef.current;\n    const canvas = canvasRef.current;\n    const ctx = canvas.getContext('2d');\n    if (!ctx || video.readyState !== 4) return;\n    canvas.width = video.videoWidth || 640;\n    canvas.height = video.videoHeight || 480;\n    ctx.drawImage(video, 0, 0, canvas.width, canvas.height);\n\n    // Simple presence detection based on center region analysis\n    const centerX = canvas.width / 2;\n    const centerY = canvas.height / 2;\n    const sampleWidth = 200;\n    const sampleHeight = 200;\n    const startX = Math.max(0, centerX - sampleWidth / 2);\n    const startY = Math.max(0, centerY - sampleHeight / 2);\n    try {\n      const imageData = ctx.getImageData(startX, startY, sampleWidth, sampleHeight);\n      const data = imageData.data;\n\n      // Analyze skin tone pixels (simple heuristic)\n      let skinTonePixels = 0;\n      let totalPixels = 0;\n      let brightnessSum = 0;\n      let motionPixels = 0;\n      for (let i = 0; i < data.length; i += 4) {\n        const r = data[i];\n        const g = data[i + 1];\n        const b = data[i + 2];\n        totalPixels++;\n        const brightness = (r + g + b) / 3;\n        brightnessSum += brightness;\n\n        // Simple skin tone detection (works for various skin tones)\n        const isSkinTone = r > 60 && r < 255 && g > 40 && g < 230 && b > 20 && b < 200 && r > g && r > b && Math.abs(r - g) > 15;\n        if (isSkinTone) {\n          skinTonePixels++;\n        }\n      }\n      const skinToneRatio = skinTonePixels / totalPixels;\n      const avgBrightness = brightnessSum / totalPixels;\n\n      // Determine face presence\n      const faceDetected = skinToneRatio > 0.15 && avgBrightness > 30 && avgBrightness < 230;\n\n      // Detect multiple faces (higher skin tone ratio in multiple regions)\n      const leftImageData = ctx.getImageData(0, startY, sampleWidth / 2, sampleHeight);\n      const rightImageData = ctx.getImageData(canvas.width - sampleWidth / 2, startY, sampleWidth / 2, sampleHeight);\n      let leftSkinPixels = 0,\n        rightSkinPixels = 0;\n      for (let i = 0; i < leftImageData.data.length; i += 4) {\n        const r = leftImageData.data[i];\n        const g = leftImageData.data[i + 1];\n        const b = leftImageData.data[i + 2];\n        if (r > 60 && r < 255 && g > 40 && g < 230 && b > 20 && b < 200 && r > g && r > b) {\n          leftSkinPixels++;\n        }\n      }\n      for (let i = 0; i < rightImageData.data.length; i += 4) {\n        const r = rightImageData.data[i];\n        const g = rightImageData.data[i + 1];\n        const b = rightImageData.data[i + 2];\n        if (r > 60 && r < 255 && g > 40 && g < 230 && b > 20 && b < 200 && r > g && r > b) {\n          rightSkinPixels++;\n        }\n      }\n      const leftRatio = leftSkinPixels / (leftImageData.data.length / 4);\n      const rightRatio = rightSkinPixels / (rightImageData.data.length / 4);\n      const multipleFaces = leftRatio > 0.2 && rightRatio > 0.2 && skinToneRatio > 0.3;\n\n      // Update status\n      setProctoringStatus(prev => ({\n        ...prev,\n        faceDetected,\n        multipleFaces\n      }));\n\n      // Record violations\n      if (!faceDetected) {\n        const timeSinceLastDetection = Date.now() - lastFaceDetectedRef.current;\n        if (timeSinceLastDetection > 5000) {\n          // 5 seconds threshold\n          recordViolation('face_not_detected', 'high', 'Face not detected - candidate may have left seat');\n          lastFaceDetectedRef.current = Date.now(); // Reset to avoid spam\n        }\n      } else {\n        lastFaceDetectedRef.current = Date.now();\n      }\n      if (multipleFaces) {\n        recordViolation('multiple_faces', 'critical', 'Multiple faces detected - possible external help');\n      }\n    } catch (error) {\n      console.error('Face detection error:', error);\n    }\n  }, [recordViolation]);\n\n  // Audio level monitoring\n  const checkAudioLevels = useCallback(() => {\n    if (!analyserRef.current) return;\n    const dataArray = new Uint8Array(analyserRef.current.frequencyBinCount);\n    analyserRef.current.getByteFrequencyData(dataArray);\n    const average = dataArray.reduce((a, b) => a + b, 0) / dataArray.length;\n\n    // Detect prolonged silence (potential cheating indicator)\n    // This is logged but not flagged as violation unless extended\n    if (average < 5) {\n      // Very low audio - could be silence\n    }\n  }, []);\n\n  // Start face detection interval\n  useEffect(() => {\n    if (isActive && proctoringStatus.cameraEnabled) {\n      faceDetectionIntervalRef.current = setInterval(() => {\n        detectFacePresence();\n        checkAudioLevels();\n      }, 2000); // Check every 2 seconds\n    }\n    return () => {\n      if (faceDetectionIntervalRef.current) {\n        clearInterval(faceDetectionIntervalRef.current);\n      }\n    };\n  }, [isActive, proctoringStatus.cameraEnabled, detectFacePresence, checkAudioLevels]);\n\n  // ============== Initialization & Cleanup ==============\n\n  const initializeProctoring = useCallback(async () => {\n    const cameraSuccess = await initializeCamera();\n    if (cameraSuccess) {\n      await enterFullscreen();\n      setIsInitialized(true);\n      if (onStatusChange) {\n        onStatusChange({\n          initialized: true,\n          cameraEnabled: true\n        });\n      }\n    }\n  }, [initializeCamera, enterFullscreen, onStatusChange]);\n\n  // Cleanup\n  useEffect(() => {\n    return () => {\n      // Stop camera\n      if (streamRef.current) {\n        streamRef.current.getTracks().forEach(track => track.stop());\n      }\n      // Stop audio context\n      if (audioContextRef.current) {\n        audioContextRef.current.close();\n      }\n      // Exit fullscreen\n      if (document.fullscreenElement) {\n        document.exitFullscreen().catch(() => {});\n      }\n      // Clear intervals\n      if (faceDetectionIntervalRef.current) {\n        clearInterval(faceDetectionIntervalRef.current);\n      }\n      if (timeTrackingIntervalRef.current) {\n        clearInterval(timeTrackingIntervalRef.current);\n      }\n    };\n  }, []);\n\n  // ============== Get Proctoring Report ==============\n  const getProctoringReport = useCallback(() => {\n    return {\n      candidateName,\n      sessionStats: stats,\n      violations,\n      proctoringStatus,\n      riskLevel: calculateRiskLevel(),\n      timestamp: new Date().toISOString()\n    };\n  }, [candidateName, stats, violations, proctoringStatus]);\n  const calculateRiskLevel = () => {\n    const {\n      tabSwitches,\n      focusLost,\n      faceNotDetected,\n      multipleFacesDetected,\n      copyAttempts,\n      fullscreenExits\n    } = stats;\n    const score = tabSwitches * 10 + focusLost * 5 + faceNotDetected * 15 + multipleFacesDetected * 25 + copyAttempts * 5 + fullscreenExits * 10;\n    if (score >= 50) return 'critical';\n    if (score >= 30) return 'high';\n    if (score >= 15) return 'medium';\n    if (score > 0) return 'low';\n    return 'none';\n  };\n\n  // Expose methods via ref if needed\n  useEffect(() => {\n    window.proctoringSystem = {\n      getProctoringReport,\n      getStats: () => stats,\n      getViolations: () => violations\n    };\n  }, [getProctoringReport, stats, violations]);\n\n  // ============== Render ==============\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"proctoring-system\",\n    children: [/*#__PURE__*/_jsxDEV(\"canvas\", {\n      ref: canvasRef,\n      style: {\n        display: 'none'\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 581,\n      columnNumber: 7\n    }, this), showPreview && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: `proctoring-preview ${!proctoringStatus.faceDetected && isInitialized ? 'warning' : ''}`,\n      children: [/*#__PURE__*/_jsxDEV(\"video\", {\n        ref: videoRef,\n        autoPlay: true,\n        playsInline: true,\n        muted: true,\n        className: \"proctoring-video\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 586,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"proctoring-indicators\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: `indicator ${proctoringStatus.cameraEnabled ? 'active' : 'inactive'}`,\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"indicator-icon\",\n            children: \"\\uD83D\\uDCF7\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 597,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"indicator-label\",\n            children: \"Camera\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 598,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 596,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: `indicator ${proctoringStatus.microphoneEnabled ? 'active' : 'inactive'}`,\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"indicator-icon\",\n            children: \"\\uD83C\\uDFA4\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 601,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"indicator-label\",\n            children: \"Mic\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 602,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 600,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: `indicator ${proctoringStatus.faceDetected ? 'active' : 'warning'}`,\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"indicator-icon\",\n            children: \"\\uD83D\\uDC64\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 605,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"indicator-label\",\n            children: \"Face\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 606,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 604,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: `indicator ${proctoringStatus.isFullscreen ? 'active' : 'warning'}`,\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"indicator-icon\",\n            children: \"\\u26F6\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 609,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"indicator-label\",\n            children: \"Fullscreen\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 610,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 608,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 595,\n        columnNumber: 11\n      }, this), violations.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"violation-counter\",\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"violation-icon\",\n          children: \"\\u26A0\\uFE0F\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 617,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"violation-count\",\n          children: violations.length\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 618,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 616,\n        columnNumber: 13\n      }, this), proctoringStatus.multipleFaces && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"multiple-faces-alert\",\n        children: \"\\u26A0\\uFE0F Multiple faces detected!\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 624,\n        columnNumber: 13\n      }, this), !proctoringStatus.faceDetected && isInitialized && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"face-missing-alert\",\n        children: \"\\u26A0\\uFE0F Face not detected\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 631,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 585,\n      columnNumber: 9\n    }, this), showWarningModal && currentWarning && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"proctoring-warning-modal\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: `warning-content severity-${currentWarning.severity}`,\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"warning-icon\",\n          children: currentWarning.severity === 'critical' ? 'ðŸš¨' : currentWarning.severity === 'high' ? 'âš ï¸' : 'âš¡'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 642,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"warning-text\",\n          children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n            children: \"Proctoring Alert\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 647,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: currentWarning.message\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 648,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 646,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 641,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 640,\n      columnNumber: 9\n    }, this), cameraError && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"camera-error\",\n      children: [/*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"error-icon\",\n        children: \"\\uD83D\\uDCF7\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 657,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: [\"Camera Error: \", cameraError]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 658,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: initializeCamera,\n        className: \"retry-btn\",\n        children: \"Retry Camera Access\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 659,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 656,\n      columnNumber: 9\n    }, this), !isInitialized && !cameraError && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"proctoring-init-overlay\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"init-content\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"init-icon\",\n          children: \"\\uD83D\\uDD12\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 669,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n          children: \"Proctoring Required\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 670,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"This interview session is proctored. We need access to:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 671,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n          className: \"permission-list\",\n          children: [/*#__PURE__*/_jsxDEV(\"li\", {\n            children: \"\\uD83D\\uDCF7 Your camera (face detection)\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 673,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n            children: \"\\uD83C\\uDFA4 Your microphone (audio monitoring)\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 674,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n            children: \"\\u26F6 Fullscreen mode (focus enforcement)\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 675,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 672,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"init-notice\",\n          children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n            children: \"Note:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 678,\n            columnNumber: 15\n          }, this), \" The following actions are monitored:\", /*#__PURE__*/_jsxDEV(\"ul\", {\n            children: [/*#__PURE__*/_jsxDEV(\"li\", {\n              children: \"Tab switching & window focus\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 680,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n              children: \"Copy/paste attempts\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 681,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n              children: \"Face presence & multiple faces\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 682,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n              children: \"Screen activity\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 683,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 679,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 677,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: initializeProctoring,\n          className: \"init-btn\",\n          children: \"Enable Proctoring & Start\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 686,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 668,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 667,\n      columnNumber: 9\n    }, this), process.env.NODE_ENV === 'development' && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"proctoring-debug\",\n      children: /*#__PURE__*/_jsxDEV(\"details\", {\n        children: [/*#__PURE__*/_jsxDEV(\"summary\", {\n          children: \"Proctoring Stats\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 697,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"pre\", {\n          children: JSON.stringify(stats, null, 2)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 698,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"pre\", {\n          children: JSON.stringify(proctoringStatus, null, 2)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 699,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 696,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 695,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 579,\n    columnNumber: 5\n  }, this);\n};\n\n// Export the component and a hook for accessing proctoring data\n_s(ProctoringSystem, \"x9XffZy+bU4fMmCT4DfWcZyyQKE=\");\n_c = ProctoringSystem;\nexport default ProctoringSystem;\nexport const useProctoringReport = () => {\n  var _window$proctoringSys, _window$proctoringSys2;\n  return ((_window$proctoringSys = window.proctoringSystem) === null || _window$proctoringSys === void 0 ? void 0 : (_window$proctoringSys2 = _window$proctoringSys.getProctoringReport) === null || _window$proctoringSys2 === void 0 ? void 0 : _window$proctoringSys2.call(_window$proctoringSys)) || null;\n};\nexport const getProctoringStats = () => {\n  var _window$proctoringSys3, _window$proctoringSys4;\n  return ((_window$proctoringSys3 = window.proctoringSystem) === null || _window$proctoringSys3 === void 0 ? void 0 : (_window$proctoringSys4 = _window$proctoringSys3.getStats) === null || _window$proctoringSys4 === void 0 ? void 0 : _window$proctoringSys4.call(_window$proctoringSys3)) || null;\n};\nexport const getProctoringViolations = () => {\n  var _window$proctoringSys5, _window$proctoringSys6;\n  return ((_window$proctoringSys5 = window.proctoringSystem) === null || _window$proctoringSys5 === void 0 ? void 0 : (_window$proctoringSys6 = _window$proctoringSys5.getViolations) === null || _window$proctoringSys6 === void 0 ? void 0 : _window$proctoringSys6.call(_window$proctoringSys5)) || [];\n};\nvar _c;\n$RefreshReg$(_c, \"ProctoringSystem\");","map":{"version":3,"names":["React","useState","useEffect","useRef","useCallback","jsxDEV","_jsxDEV","ProctoringSystem","isActive","onViolation","onStatusChange","candidateName","showPreview","_s","proctoringStatus","setProctoringStatus","isFullscreen","cameraEnabled","microphoneEnabled","faceDetected","multipleFaces","isTabFocused","isBrowserFocused","violations","setViolations","warnings","setWarnings","stats","setStats","tabSwitches","focusLost","faceNotDetected","multipleFacesDetected","copyAttempts","pasteAttempts","fullscreenExits","totalTime","activeTime","suspiciousBehaviors","cameraError","setCameraError","isInitialized","setIsInitialized","showWarningModal","setShowWarningModal","currentWarning","setCurrentWarning","videoRef","canvasRef","streamRef","faceDetectionIntervalRef","timeTrackingIntervalRef","lastFaceDetectedRef","Date","now","audioContextRef","analyserRef","microphoneStreamRef","recordViolation","type","severity","message","violation","id","timestamp","toISOString","prev","setTimeout","newStats","enterFullscreen","elem","document","documentElement","requestFullscreen","webkitRequestFullscreen","msRequestFullscreen","error","console","handleFullscreenChange","fullscreenElement","webkitFullscreenElement","msFullscreenElement","addEventListener","removeEventListener","handleVisibilityChange","isVisible","visibilityState","handleFocus","handleBlur","window","handleCopy","e","preventDefault","handlePaste","handleCut","handleContextMenu","handleKeyDown","ctrlKey","includes","key","toLowerCase","shiftKey","current","setInterval","clearInterval","initializeCamera","stream","navigator","mediaDevices","getUserMedia","video","width","ideal","height","facingMode","audio","srcObject","play","audioTrack","getAudioTracks","AudioContext","webkitAudioContext","source","createMediaStreamSource","MediaStream","createAnalyser","fftSize","connect","detectFacePresence","canvas","ctx","getContext","readyState","videoWidth","videoHeight","drawImage","centerX","centerY","sampleWidth","sampleHeight","startX","Math","max","startY","imageData","getImageData","data","skinTonePixels","totalPixels","brightnessSum","motionPixels","i","length","r","g","b","brightness","isSkinTone","abs","skinToneRatio","avgBrightness","leftImageData","rightImageData","leftSkinPixels","rightSkinPixels","leftRatio","rightRatio","timeSinceLastDetection","checkAudioLevels","dataArray","Uint8Array","frequencyBinCount","getByteFrequencyData","average","reduce","a","initializeProctoring","cameraSuccess","initialized","getTracks","forEach","track","stop","close","exitFullscreen","catch","getProctoringReport","sessionStats","riskLevel","calculateRiskLevel","score","proctoringSystem","getStats","getViolations","className","children","ref","style","display","fileName","_jsxFileName","lineNumber","columnNumber","autoPlay","playsInline","muted","onClick","process","env","NODE_ENV","JSON","stringify","_c","useProctoringReport","_window$proctoringSys","_window$proctoringSys2","call","getProctoringStats","_window$proctoringSys3","_window$proctoringSys4","getProctoringViolations","_window$proctoringSys5","_window$proctoringSys6","$RefreshReg$"],"sources":["D:/Project/gcc-hiring-system/frontend/src/components/ProctoringSystem.jsx"],"sourcesContent":["import React, { useState, useEffect, useRef, useCallback } from 'react';\r\nimport '../styles/ProctoringSystem.css';\r\n\r\n/**\r\n * Enterprise-Grade Proctoring System\r\n * \r\n * Level 1: Basic Proctoring\r\n * - Full-screen enforcement\r\n * - Tab-switch detection\r\n * - Copy-paste blocking\r\n * - Time tracking\r\n * - Browser focus monitoring\r\n * \r\n * Level 2: Advanced Proctoring\r\n * - Webcam monitoring\r\n * - Face presence detection\r\n * - Multiple face detection\r\n * - Microphone activity monitoring\r\n * - Behavioral flags\r\n */\r\n\r\nconst ProctoringSystem = ({ \r\n  isActive = false, \r\n  onViolation, \r\n  onStatusChange,\r\n  candidateName = 'Candidate',\r\n  showPreview = true \r\n}) => {\r\n  // ============== State Management ==============\r\n  const [proctoringStatus, setProctoringStatus] = useState({\r\n    isFullscreen: false,\r\n    cameraEnabled: false,\r\n    microphoneEnabled: false,\r\n    faceDetected: false,\r\n    multipleFaces: false,\r\n    isTabFocused: true,\r\n    isBrowserFocused: true,\r\n  });\r\n\r\n  const [violations, setViolations] = useState([]);\r\n  const [warnings, setWarnings] = useState([]);\r\n  const [stats, setStats] = useState({\r\n    tabSwitches: 0,\r\n    focusLost: 0,\r\n    faceNotDetected: 0,\r\n    multipleFacesDetected: 0,\r\n    copyAttempts: 0,\r\n    pasteAttempts: 0,\r\n    fullscreenExits: 0,\r\n    totalTime: 0,\r\n    activeTime: 0,\r\n    suspiciousBehaviors: 0,\r\n  });\r\n\r\n  const [cameraError, setCameraError] = useState(null);\r\n  const [isInitialized, setIsInitialized] = useState(false);\r\n  const [showWarningModal, setShowWarningModal] = useState(false);\r\n  const [currentWarning, setCurrentWarning] = useState(null);\r\n\r\n  // ============== Refs ==============\r\n  const videoRef = useRef(null);\r\n  const canvasRef = useRef(null);\r\n  const streamRef = useRef(null);\r\n  const faceDetectionIntervalRef = useRef(null);\r\n  const timeTrackingIntervalRef = useRef(null);\r\n  const lastFaceDetectedRef = useRef(Date.now());\r\n  const audioContextRef = useRef(null);\r\n  const analyserRef = useRef(null);\r\n  const microphoneStreamRef = useRef(null);\r\n\r\n  // ============== Violation Recording ==============\r\n  const recordViolation = useCallback((type, severity, message) => {\r\n    const violation = {\r\n      id: Date.now(),\r\n      type,\r\n      severity, // 'low', 'medium', 'high', 'critical'\r\n      message,\r\n      timestamp: new Date().toISOString(),\r\n    };\r\n\r\n    setViolations(prev => [...prev, violation]);\r\n\r\n    if (onViolation) {\r\n      onViolation(violation);\r\n    }\r\n\r\n    // Show warning for medium+ severity\r\n    if (severity !== 'low') {\r\n      setCurrentWarning(violation);\r\n      setShowWarningModal(true);\r\n      setTimeout(() => setShowWarningModal(false), 4000);\r\n    }\r\n\r\n    // Update stats based on type\r\n    setStats(prev => {\r\n      const newStats = { ...prev };\r\n      switch (type) {\r\n        case 'tab_switch':\r\n          newStats.tabSwitches++;\r\n          break;\r\n        case 'focus_lost':\r\n          newStats.focusLost++;\r\n          break;\r\n        case 'face_not_detected':\r\n          newStats.faceNotDetected++;\r\n          break;\r\n        case 'multiple_faces':\r\n          newStats.multipleFacesDetected++;\r\n          break;\r\n        case 'copy_attempt':\r\n          newStats.copyAttempts++;\r\n          break;\r\n        case 'paste_attempt':\r\n          newStats.pasteAttempts++;\r\n          break;\r\n        case 'fullscreen_exit':\r\n          newStats.fullscreenExits++;\r\n          break;\r\n        default:\r\n          newStats.suspiciousBehaviors++;\r\n      }\r\n      return newStats;\r\n    });\r\n  }, [onViolation]);\r\n\r\n  // ============== Level 1: Basic Proctoring ==============\r\n\r\n  // Full-screen enforcement\r\n  const enterFullscreen = useCallback(async () => {\r\n    try {\r\n      const elem = document.documentElement;\r\n      if (elem.requestFullscreen) {\r\n        await elem.requestFullscreen();\r\n      } else if (elem.webkitRequestFullscreen) {\r\n        await elem.webkitRequestFullscreen();\r\n      } else if (elem.msRequestFullscreen) {\r\n        await elem.msRequestFullscreen();\r\n      }\r\n      setProctoringStatus(prev => ({ ...prev, isFullscreen: true }));\r\n    } catch (error) {\r\n      console.error('Fullscreen error:', error);\r\n      recordViolation('fullscreen_denied', 'high', 'Fullscreen mode was denied');\r\n    }\r\n  }, [recordViolation]);\r\n\r\n  // Fullscreen change handler\r\n  useEffect(() => {\r\n    const handleFullscreenChange = () => {\r\n      const isFullscreen = !!(\r\n        document.fullscreenElement ||\r\n        document.webkitFullscreenElement ||\r\n        document.msFullscreenElement\r\n      );\r\n      \r\n      setProctoringStatus(prev => ({ ...prev, isFullscreen }));\r\n      \r\n      if (!isFullscreen && isActive && isInitialized) {\r\n        recordViolation('fullscreen_exit', 'high', 'Exited fullscreen mode');\r\n        // Re-enter fullscreen after a short delay\r\n        setTimeout(() => {\r\n          if (isActive) enterFullscreen();\r\n        }, 1000);\r\n      }\r\n    };\r\n\r\n    document.addEventListener('fullscreenchange', handleFullscreenChange);\r\n    document.addEventListener('webkitfullscreenchange', handleFullscreenChange);\r\n    document.addEventListener('msfullscreenchange', handleFullscreenChange);\r\n\r\n    return () => {\r\n      document.removeEventListener('fullscreenchange', handleFullscreenChange);\r\n      document.removeEventListener('webkitfullscreenchange', handleFullscreenChange);\r\n      document.removeEventListener('msfullscreenchange', handleFullscreenChange);\r\n    };\r\n  }, [isActive, isInitialized, enterFullscreen, recordViolation]);\r\n\r\n  // Tab visibility detection\r\n  useEffect(() => {\r\n    const handleVisibilityChange = () => {\r\n      const isVisible = document.visibilityState === 'visible';\r\n      \r\n      setProctoringStatus(prev => ({ ...prev, isTabFocused: isVisible }));\r\n      \r\n      if (!isVisible && isActive) {\r\n        recordViolation('tab_switch', 'high', 'Switched to another tab');\r\n      }\r\n    };\r\n\r\n    document.addEventListener('visibilitychange', handleVisibilityChange);\r\n    return () => document.removeEventListener('visibilitychange', handleVisibilityChange);\r\n  }, [isActive, recordViolation]);\r\n\r\n  // Browser focus detection\r\n  useEffect(() => {\r\n    const handleFocus = () => {\r\n      setProctoringStatus(prev => ({ ...prev, isBrowserFocused: true }));\r\n    };\r\n\r\n    const handleBlur = () => {\r\n      setProctoringStatus(prev => ({ ...prev, isBrowserFocused: false }));\r\n      if (isActive) {\r\n        recordViolation('focus_lost', 'medium', 'Browser window lost focus');\r\n      }\r\n    };\r\n\r\n    window.addEventListener('focus', handleFocus);\r\n    window.addEventListener('blur', handleBlur);\r\n\r\n    return () => {\r\n      window.removeEventListener('focus', handleFocus);\r\n      window.removeEventListener('blur', handleBlur);\r\n    };\r\n  }, [isActive, recordViolation]);\r\n\r\n  // Copy-paste blocking\r\n  useEffect(() => {\r\n    const handleCopy = (e) => {\r\n      if (isActive) {\r\n        e.preventDefault();\r\n        recordViolation('copy_attempt', 'medium', 'Attempted to copy content');\r\n      }\r\n    };\r\n\r\n    const handlePaste = (e) => {\r\n      if (isActive) {\r\n        e.preventDefault();\r\n        recordViolation('paste_attempt', 'medium', 'Attempted to paste content');\r\n      }\r\n    };\r\n\r\n    const handleCut = (e) => {\r\n      if (isActive) {\r\n        e.preventDefault();\r\n        recordViolation('cut_attempt', 'medium', 'Attempted to cut content');\r\n      }\r\n    };\r\n\r\n    // Block right-click context menu\r\n    const handleContextMenu = (e) => {\r\n      if (isActive) {\r\n        e.preventDefault();\r\n        recordViolation('context_menu', 'low', 'Attempted to open context menu');\r\n      }\r\n    };\r\n\r\n    // Block keyboard shortcuts\r\n    const handleKeyDown = (e) => {\r\n      if (isActive) {\r\n        // Block Ctrl+C, Ctrl+V, Ctrl+X, Ctrl+A, F12, etc.\r\n        if (\r\n          (e.ctrlKey && ['c', 'v', 'x', 'a', 'u', 's', 'p'].includes(e.key.toLowerCase())) ||\r\n          e.key === 'F12' ||\r\n          (e.ctrlKey && e.shiftKey && ['i', 'j', 'c'].includes(e.key.toLowerCase()))\r\n        ) {\r\n          e.preventDefault();\r\n          recordViolation('keyboard_shortcut', 'low', `Blocked keyboard shortcut: ${e.key}`);\r\n        }\r\n      }\r\n    };\r\n\r\n    document.addEventListener('copy', handleCopy);\r\n    document.addEventListener('paste', handlePaste);\r\n    document.addEventListener('cut', handleCut);\r\n    document.addEventListener('contextmenu', handleContextMenu);\r\n    document.addEventListener('keydown', handleKeyDown);\r\n\r\n    return () => {\r\n      document.removeEventListener('copy', handleCopy);\r\n      document.removeEventListener('paste', handlePaste);\r\n      document.removeEventListener('cut', handleCut);\r\n      document.removeEventListener('contextmenu', handleContextMenu);\r\n      document.removeEventListener('keydown', handleKeyDown);\r\n    };\r\n  }, [isActive, recordViolation]);\r\n\r\n  // Time tracking\r\n  useEffect(() => {\r\n    if (isActive) {\r\n      timeTrackingIntervalRef.current = setInterval(() => {\r\n        setStats(prev => ({\r\n          ...prev,\r\n          totalTime: prev.totalTime + 1,\r\n          activeTime: proctoringStatus.isBrowserFocused && proctoringStatus.isTabFocused \r\n            ? prev.activeTime + 1 \r\n            : prev.activeTime,\r\n        }));\r\n      }, 1000);\r\n    }\r\n\r\n    return () => {\r\n      if (timeTrackingIntervalRef.current) {\r\n        clearInterval(timeTrackingIntervalRef.current);\r\n      }\r\n    };\r\n  }, [isActive, proctoringStatus.isBrowserFocused, proctoringStatus.isTabFocused]);\r\n\r\n  // ============== Level 2: Advanced Proctoring ==============\r\n\r\n  // Initialize camera\r\n  const initializeCamera = useCallback(async () => {\r\n    try {\r\n      const stream = await navigator.mediaDevices.getUserMedia({\r\n        video: {\r\n          width: { ideal: 640 },\r\n          height: { ideal: 480 },\r\n          facingMode: 'user',\r\n        },\r\n        audio: true,\r\n      });\r\n\r\n      streamRef.current = stream;\r\n\r\n      if (videoRef.current) {\r\n        videoRef.current.srcObject = stream;\r\n        await videoRef.current.play();\r\n      }\r\n\r\n      // Set up audio analysis\r\n      const audioTrack = stream.getAudioTracks()[0];\r\n      if (audioTrack) {\r\n        audioContextRef.current = new (window.AudioContext || window.webkitAudioContext)();\r\n        const source = audioContextRef.current.createMediaStreamSource(\r\n          new MediaStream([audioTrack])\r\n        );\r\n        analyserRef.current = audioContextRef.current.createAnalyser();\r\n        analyserRef.current.fftSize = 256;\r\n        source.connect(analyserRef.current);\r\n        microphoneStreamRef.current = stream;\r\n      }\r\n\r\n      setProctoringStatus(prev => ({\r\n        ...prev,\r\n        cameraEnabled: true,\r\n        microphoneEnabled: !!audioTrack,\r\n      }));\r\n\r\n      setCameraError(null);\r\n      return true;\r\n    } catch (error) {\r\n      console.error('Camera initialization error:', error);\r\n      setCameraError(error.message || 'Failed to access camera');\r\n      recordViolation('camera_denied', 'critical', 'Camera access was denied');\r\n      return false;\r\n    }\r\n  }, [recordViolation]);\r\n\r\n  // Face detection using simple motion/presence detection\r\n  // (No ML library needed - uses pixel analysis)\r\n  const detectFacePresence = useCallback(() => {\r\n    if (!videoRef.current || !canvasRef.current) return;\r\n\r\n    const video = videoRef.current;\r\n    const canvas = canvasRef.current;\r\n    const ctx = canvas.getContext('2d');\r\n\r\n    if (!ctx || video.readyState !== 4) return;\r\n\r\n    canvas.width = video.videoWidth || 640;\r\n    canvas.height = video.videoHeight || 480;\r\n\r\n    ctx.drawImage(video, 0, 0, canvas.width, canvas.height);\r\n\r\n    // Simple presence detection based on center region analysis\r\n    const centerX = canvas.width / 2;\r\n    const centerY = canvas.height / 2;\r\n    const sampleWidth = 200;\r\n    const sampleHeight = 200;\r\n\r\n    const startX = Math.max(0, centerX - sampleWidth / 2);\r\n    const startY = Math.max(0, centerY - sampleHeight / 2);\r\n\r\n    try {\r\n      const imageData = ctx.getImageData(startX, startY, sampleWidth, sampleHeight);\r\n      const data = imageData.data;\r\n\r\n      // Analyze skin tone pixels (simple heuristic)\r\n      let skinTonePixels = 0;\r\n      let totalPixels = 0;\r\n      let brightnessSum = 0;\r\n      let motionPixels = 0;\r\n\r\n      for (let i = 0; i < data.length; i += 4) {\r\n        const r = data[i];\r\n        const g = data[i + 1];\r\n        const b = data[i + 2];\r\n        totalPixels++;\r\n\r\n        const brightness = (r + g + b) / 3;\r\n        brightnessSum += brightness;\r\n\r\n        // Simple skin tone detection (works for various skin tones)\r\n        const isSkinTone = (\r\n          r > 60 && r < 255 &&\r\n          g > 40 && g < 230 &&\r\n          b > 20 && b < 200 &&\r\n          r > g && r > b &&\r\n          Math.abs(r - g) > 15\r\n        );\r\n\r\n        if (isSkinTone) {\r\n          skinTonePixels++;\r\n        }\r\n      }\r\n\r\n      const skinToneRatio = skinTonePixels / totalPixels;\r\n      const avgBrightness = brightnessSum / totalPixels;\r\n\r\n      // Determine face presence\r\n      const faceDetected = skinToneRatio > 0.15 && avgBrightness > 30 && avgBrightness < 230;\r\n\r\n      // Detect multiple faces (higher skin tone ratio in multiple regions)\r\n      const leftImageData = ctx.getImageData(0, startY, sampleWidth / 2, sampleHeight);\r\n      const rightImageData = ctx.getImageData(canvas.width - sampleWidth / 2, startY, sampleWidth / 2, sampleHeight);\r\n\r\n      let leftSkinPixels = 0, rightSkinPixels = 0;\r\n      \r\n      for (let i = 0; i < leftImageData.data.length; i += 4) {\r\n        const r = leftImageData.data[i];\r\n        const g = leftImageData.data[i + 1];\r\n        const b = leftImageData.data[i + 2];\r\n        if (r > 60 && r < 255 && g > 40 && g < 230 && b > 20 && b < 200 && r > g && r > b) {\r\n          leftSkinPixels++;\r\n        }\r\n      }\r\n\r\n      for (let i = 0; i < rightImageData.data.length; i += 4) {\r\n        const r = rightImageData.data[i];\r\n        const g = rightImageData.data[i + 1];\r\n        const b = rightImageData.data[i + 2];\r\n        if (r > 60 && r < 255 && g > 40 && g < 230 && b > 20 && b < 200 && r > g && r > b) {\r\n          rightSkinPixels++;\r\n        }\r\n      }\r\n\r\n      const leftRatio = leftSkinPixels / (leftImageData.data.length / 4);\r\n      const rightRatio = rightSkinPixels / (rightImageData.data.length / 4);\r\n      const multipleFaces = leftRatio > 0.2 && rightRatio > 0.2 && skinToneRatio > 0.3;\r\n\r\n      // Update status\r\n      setProctoringStatus(prev => ({\r\n        ...prev,\r\n        faceDetected,\r\n        multipleFaces,\r\n      }));\r\n\r\n      // Record violations\r\n      if (!faceDetected) {\r\n        const timeSinceLastDetection = Date.now() - lastFaceDetectedRef.current;\r\n        if (timeSinceLastDetection > 5000) { // 5 seconds threshold\r\n          recordViolation('face_not_detected', 'high', 'Face not detected - candidate may have left seat');\r\n          lastFaceDetectedRef.current = Date.now(); // Reset to avoid spam\r\n        }\r\n      } else {\r\n        lastFaceDetectedRef.current = Date.now();\r\n      }\r\n\r\n      if (multipleFaces) {\r\n        recordViolation('multiple_faces', 'critical', 'Multiple faces detected - possible external help');\r\n      }\r\n\r\n    } catch (error) {\r\n      console.error('Face detection error:', error);\r\n    }\r\n  }, [recordViolation]);\r\n\r\n  // Audio level monitoring\r\n  const checkAudioLevels = useCallback(() => {\r\n    if (!analyserRef.current) return;\r\n\r\n    const dataArray = new Uint8Array(analyserRef.current.frequencyBinCount);\r\n    analyserRef.current.getByteFrequencyData(dataArray);\r\n\r\n    const average = dataArray.reduce((a, b) => a + b, 0) / dataArray.length;\r\n\r\n    // Detect prolonged silence (potential cheating indicator)\r\n    // This is logged but not flagged as violation unless extended\r\n    if (average < 5) {\r\n      // Very low audio - could be silence\r\n    }\r\n  }, []);\r\n\r\n  // Start face detection interval\r\n  useEffect(() => {\r\n    if (isActive && proctoringStatus.cameraEnabled) {\r\n      faceDetectionIntervalRef.current = setInterval(() => {\r\n        detectFacePresence();\r\n        checkAudioLevels();\r\n      }, 2000); // Check every 2 seconds\r\n    }\r\n\r\n    return () => {\r\n      if (faceDetectionIntervalRef.current) {\r\n        clearInterval(faceDetectionIntervalRef.current);\r\n      }\r\n    };\r\n  }, [isActive, proctoringStatus.cameraEnabled, detectFacePresence, checkAudioLevels]);\r\n\r\n  // ============== Initialization & Cleanup ==============\r\n\r\n  const initializeProctoring = useCallback(async () => {\r\n    const cameraSuccess = await initializeCamera();\r\n    \r\n    if (cameraSuccess) {\r\n      await enterFullscreen();\r\n      setIsInitialized(true);\r\n      \r\n      if (onStatusChange) {\r\n        onStatusChange({ initialized: true, cameraEnabled: true });\r\n      }\r\n    }\r\n  }, [initializeCamera, enterFullscreen, onStatusChange]);\r\n\r\n  // Cleanup\r\n  useEffect(() => {\r\n    return () => {\r\n      // Stop camera\r\n      if (streamRef.current) {\r\n        streamRef.current.getTracks().forEach(track => track.stop());\r\n      }\r\n      // Stop audio context\r\n      if (audioContextRef.current) {\r\n        audioContextRef.current.close();\r\n      }\r\n      // Exit fullscreen\r\n      if (document.fullscreenElement) {\r\n        document.exitFullscreen().catch(() => {});\r\n      }\r\n      // Clear intervals\r\n      if (faceDetectionIntervalRef.current) {\r\n        clearInterval(faceDetectionIntervalRef.current);\r\n      }\r\n      if (timeTrackingIntervalRef.current) {\r\n        clearInterval(timeTrackingIntervalRef.current);\r\n      }\r\n    };\r\n  }, []);\r\n\r\n  // ============== Get Proctoring Report ==============\r\n  const getProctoringReport = useCallback(() => {\r\n    return {\r\n      candidateName,\r\n      sessionStats: stats,\r\n      violations,\r\n      proctoringStatus,\r\n      riskLevel: calculateRiskLevel(),\r\n      timestamp: new Date().toISOString(),\r\n    };\r\n  }, [candidateName, stats, violations, proctoringStatus]);\r\n\r\n  const calculateRiskLevel = () => {\r\n    const { tabSwitches, focusLost, faceNotDetected, multipleFacesDetected, copyAttempts, fullscreenExits } = stats;\r\n    \r\n    const score = \r\n      (tabSwitches * 10) +\r\n      (focusLost * 5) +\r\n      (faceNotDetected * 15) +\r\n      (multipleFacesDetected * 25) +\r\n      (copyAttempts * 5) +\r\n      (fullscreenExits * 10);\r\n\r\n    if (score >= 50) return 'critical';\r\n    if (score >= 30) return 'high';\r\n    if (score >= 15) return 'medium';\r\n    if (score > 0) return 'low';\r\n    return 'none';\r\n  };\r\n\r\n  // Expose methods via ref if needed\r\n  useEffect(() => {\r\n    window.proctoringSystem = {\r\n      getProctoringReport,\r\n      getStats: () => stats,\r\n      getViolations: () => violations,\r\n    };\r\n  }, [getProctoringReport, stats, violations]);\r\n\r\n  // ============== Render ==============\r\n  return (\r\n    <div className=\"proctoring-system\">\r\n      {/* Hidden canvas for face detection processing */}\r\n      <canvas ref={canvasRef} style={{ display: 'none' }} />\r\n\r\n      {/* Camera Preview */}\r\n      {showPreview && (\r\n        <div className={`proctoring-preview ${!proctoringStatus.faceDetected && isInitialized ? 'warning' : ''}`}>\r\n          <video\r\n            ref={videoRef}\r\n            autoPlay\r\n            playsInline\r\n            muted\r\n            className=\"proctoring-video\"\r\n          />\r\n          \r\n          {/* Status Indicators */}\r\n          <div className=\"proctoring-indicators\">\r\n            <div className={`indicator ${proctoringStatus.cameraEnabled ? 'active' : 'inactive'}`}>\r\n              <span className=\"indicator-icon\">ðŸ“·</span>\r\n              <span className=\"indicator-label\">Camera</span>\r\n            </div>\r\n            <div className={`indicator ${proctoringStatus.microphoneEnabled ? 'active' : 'inactive'}`}>\r\n              <span className=\"indicator-icon\">ðŸŽ¤</span>\r\n              <span className=\"indicator-label\">Mic</span>\r\n            </div>\r\n            <div className={`indicator ${proctoringStatus.faceDetected ? 'active' : 'warning'}`}>\r\n              <span className=\"indicator-icon\">ðŸ‘¤</span>\r\n              <span className=\"indicator-label\">Face</span>\r\n            </div>\r\n            <div className={`indicator ${proctoringStatus.isFullscreen ? 'active' : 'warning'}`}>\r\n              <span className=\"indicator-icon\">â›¶</span>\r\n              <span className=\"indicator-label\">Fullscreen</span>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Violation Counter */}\r\n          {violations.length > 0 && (\r\n            <div className=\"violation-counter\">\r\n              <span className=\"violation-icon\">âš ï¸</span>\r\n              <span className=\"violation-count\">{violations.length}</span>\r\n            </div>\r\n          )}\r\n\r\n          {/* Multiple Faces Warning */}\r\n          {proctoringStatus.multipleFaces && (\r\n            <div className=\"multiple-faces-alert\">\r\n              âš ï¸ Multiple faces detected!\r\n            </div>\r\n          )}\r\n\r\n          {/* Face Not Detected Warning */}\r\n          {!proctoringStatus.faceDetected && isInitialized && (\r\n            <div className=\"face-missing-alert\">\r\n              âš ï¸ Face not detected\r\n            </div>\r\n          )}\r\n        </div>\r\n      )}\r\n\r\n      {/* Warning Modal */}\r\n      {showWarningModal && currentWarning && (\r\n        <div className=\"proctoring-warning-modal\">\r\n          <div className={`warning-content severity-${currentWarning.severity}`}>\r\n            <span className=\"warning-icon\">\r\n              {currentWarning.severity === 'critical' ? 'ðŸš¨' : \r\n               currentWarning.severity === 'high' ? 'âš ï¸' : 'âš¡'}\r\n            </span>\r\n            <div className=\"warning-text\">\r\n              <strong>Proctoring Alert</strong>\r\n              <p>{currentWarning.message}</p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Camera Error State */}\r\n      {cameraError && (\r\n        <div className=\"camera-error\">\r\n          <span className=\"error-icon\">ðŸ“·</span>\r\n          <p>Camera Error: {cameraError}</p>\r\n          <button onClick={initializeCamera} className=\"retry-btn\">\r\n            Retry Camera Access\r\n          </button>\r\n        </div>\r\n      )}\r\n\r\n      {/* Initialize Button (shown before proctoring starts) */}\r\n      {!isInitialized && !cameraError && (\r\n        <div className=\"proctoring-init-overlay\">\r\n          <div className=\"init-content\">\r\n            <div className=\"init-icon\">ðŸ”’</div>\r\n            <h3>Proctoring Required</h3>\r\n            <p>This interview session is proctored. We need access to:</p>\r\n            <ul className=\"permission-list\">\r\n              <li>ðŸ“· Your camera (face detection)</li>\r\n              <li>ðŸŽ¤ Your microphone (audio monitoring)</li>\r\n              <li>â›¶ Fullscreen mode (focus enforcement)</li>\r\n            </ul>\r\n            <div className=\"init-notice\">\r\n              <strong>Note:</strong> The following actions are monitored:\r\n              <ul>\r\n                <li>Tab switching & window focus</li>\r\n                <li>Copy/paste attempts</li>\r\n                <li>Face presence & multiple faces</li>\r\n                <li>Screen activity</li>\r\n              </ul>\r\n            </div>\r\n            <button onClick={initializeProctoring} className=\"init-btn\">\r\n              Enable Proctoring & Start\r\n            </button>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Stats Panel (for debugging/admin view) */}\r\n      {process.env.NODE_ENV === 'development' && (\r\n        <div className=\"proctoring-debug\">\r\n          <details>\r\n            <summary>Proctoring Stats</summary>\r\n            <pre>{JSON.stringify(stats, null, 2)}</pre>\r\n            <pre>{JSON.stringify(proctoringStatus, null, 2)}</pre>\r\n          </details>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\n// Export the component and a hook for accessing proctoring data\r\nexport default ProctoringSystem;\r\n\r\nexport const useProctoringReport = () => {\r\n  return window.proctoringSystem?.getProctoringReport?.() || null;\r\n};\r\n\r\nexport const getProctoringStats = () => {\r\n  return window.proctoringSystem?.getStats?.() || null;\r\n};\r\n\r\nexport const getProctoringViolations = () => {\r\n  return window.proctoringSystem?.getViolations?.() || [];\r\n};\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}